import{i as V,V as K}from"./4nfXJs0B.js";import{t as N}from"./Bk6qo1r0.js";import{b as G,u as q}from"./Cca8yeN8.js";import{d as D,p as w,c as k,q as U,s as X,b as C,i as T,t as Y,j as Z,u as A,e as J,m as Q,o as ee}from"./CszauIMC.js";import{d as oe,c as y,r as x,e as R,x as re,Z as te,A as ne,w as se,i as $}from"./CtvzWlFT.js";const ae=V&&"loading"in document.createElement("img");function ie(e={}){var i;const{root:s=null}=e;return{hash:`${e.rootMargin||"0px 0px 0px 0px"}-${Array.isArray(e.threshold)?e.threshold.join(","):(i=e.threshold)!==null&&i!==void 0?i:"0"}`,options:Object.assign(Object.assign({},e),{root:(typeof s=="string"?document.querySelector(s):s)||document.documentElement})}}const F=new WeakMap,M=new WeakMap,_=new WeakMap,le=(e,i,s)=>{if(!e)return()=>{};const a=ie(i),{root:d}=a.options;let n;const c=F.get(d);c?n=c:(n=new Map,F.set(d,n));let f,t;n.has(a.hash)?(t=n.get(a.hash),t[1].has(e)||(f=t[0],t[1].add(e),f.observe(e))):(f=new IntersectionObserver(m=>{m.forEach(h=>{if(h.isIntersecting){const b=M.get(h.target),O=_.get(h.target);b&&b(),O&&(O.value=!0)}})},a.options),f.observe(e),t=[f,new Set([e])],n.set(a.hash,t));let u=!1;const v=()=>{u||(M.delete(e),_.delete(e),u=!0,t[1].has(e)&&(t[0].unobserve(e),t[1].delete(e)),t[1].size<=0&&n.delete(a.hash),n.size||F.delete(d))};return M.set(e,v),_.set(e,s),v};function de(e){const{borderRadius:i,avatarColor:s,cardColor:a,fontSize:d,heightTiny:n,heightSmall:c,heightMedium:f,heightLarge:t,heightHuge:u,modalColor:v,popoverColor:m}=e;return{borderRadius:i,fontSize:d,border:`2px solid ${a}`,heightTiny:n,heightSmall:c,heightMedium:f,heightLarge:t,heightHuge:u,color:w(a,s),colorModal:w(v,s),colorPopover:w(m,s)}}const ce={common:D,self:de},ue=G("n-avatar-group"),fe=k("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[U(C("&","--n-merged-color: var(--n-color-modal);")),X(C("&","--n-merged-color: var(--n-color-popover);")),C("img",`
 width: 100%;
 height: 100%;
 `),T("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),k("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),T("text","line-height: 1.25")]),ve=Object.assign(Object.assign({},A.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),ze=oe({name:"Avatar",props:ve,slots:Object,setup(e){const{mergedClsPrefixRef:i,inlineThemeDisabled:s}=q(e),a=x(!1);let d=null;const n=x(null),c=x(null),f=()=>{const{value:o}=n;if(o&&(d===null||d!==o.innerHTML)){d=o.innerHTML;const{value:r}=c;if(r){const{offsetWidth:l,offsetHeight:p}=r,{offsetWidth:g,offsetHeight:L}=o,S=.9,E=Math.min(l/g*S,p/L*S,1);o.style.transform=`translateX(-50%) translateY(-50%) scale(${E})`}}},t=$(ue,null),u=R(()=>{const{size:o}=e;if(o)return o;const{size:r}=t||{};return r||"medium"}),v=A("Avatar","-avatar",fe,ce,e,i),m=$(N,null),h=R(()=>{if(t)return!0;const{round:o,circle:r}=e;return o!==void 0||r!==void 0?o||r:m?m.roundRef.value:!1}),b=R(()=>t?!0:e.bordered||!1),O=R(()=>{const o=u.value,r=h.value,l=b.value,{color:p}=e,{self:{borderRadius:g,fontSize:L,color:S,border:E,colorModal:B,colorPopover:I},common:{cubicBezierEaseInOut:W}}=v.value;let P;return typeof o=="number"?P=`${o}px`:P=v.value.self[Q("height",o)],{"--n-font-size":L,"--n-border":l?E:"none","--n-border-radius":r?"50%":g,"--n-color":p||S,"--n-color-modal":p||B,"--n-color-popover":p||I,"--n-bezier":W,"--n-merged-size":`var(--n-avatar-size-override, ${P})`}}),z=s?J("avatar",R(()=>{const o=u.value,r=h.value,l=b.value,{color:p}=e;let g="";return o&&(typeof o=="number"?g+=`a${o}`:g+=o[0]),r&&(g+="b"),l&&(g+="c"),p&&(g+=ee(p)),g}),O,e):void 0,j=x(!e.lazy);re(()=>{if(e.lazy&&e.intersectionObserverOptions){let o;const r=te(()=>{o==null||o(),o=void 0,e.lazy&&(o=le(c.value,e.intersectionObserverOptions,j))});ne(()=>{r(),o==null||o()})}}),se(()=>{var o;return e.src||((o=e.imgProps)===null||o===void 0?void 0:o.src)},()=>{a.value=!1});const H=x(!e.lazy);return{textRef:n,selfRef:c,mergedRoundRef:h,mergedClsPrefix:i,fitTextTransform:f,cssVars:s?void 0:O,themeClass:z==null?void 0:z.themeClass,onRender:z==null?void 0:z.onRender,hasLoadError:a,shouldStartLoading:j,loaded:H,mergedOnError:o=>{if(!j.value)return;a.value=!0;const{onError:r,imgProps:{onError:l}={}}=e;r==null||r(o),l==null||l(o)},mergedOnLoad:o=>{const{onLoad:r,imgProps:{onLoad:l}={}}=e;r==null||r(o),l==null||l(o),H.value=!0}}},render(){var e,i;const{$slots:s,src:a,mergedClsPrefix:d,lazy:n,onRender:c,loaded:f,hasLoadError:t,imgProps:u={}}=this;c==null||c();let v;const m=!f&&!t&&(this.renderPlaceholder?this.renderPlaceholder():(i=(e=this.$slots).placeholder)===null||i===void 0?void 0:i.call(e));return this.hasLoadError?v=this.renderFallback?this.renderFallback():Y(s.fallback,()=>[y("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):v=Z(s.default,h=>{if(h)return y(K,{onResize:this.fitTextTransform},{default:()=>y("span",{ref:"textRef",class:`${d}-avatar__text`},h)});if(a||u.src){const b=this.src||u.src;return y("img",Object.assign(Object.assign({},u),{loading:ae&&!this.intersectionObserverOptions&&n?"lazy":"eager",src:n&&this.intersectionObserverOptions?this.shouldStartLoading?b:void 0:b,"data-image-src":b,onLoad:this.mergedOnLoad,onError:this.mergedOnError,style:[u.style||"",{objectFit:this.objectFit},m?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),y("span",{ref:"selfRef",class:[`${d}-avatar`,this.themeClass],style:this.cssVars},v,n&&m)}});export{ze as _};
